# CORS Configuration Fix Guide

This guide provides step-by-step instructions for fixing CORS (Cross-Origin Resource Sharing) issues between your frontend (https://manish-steel-furniture-m9ayaff4c-manishh101s-projects.vercel.app) and backend (https://manish-steel-api.vercel.app) deployments.

## 1. Understanding the Issue

CORS errors occur when your frontend application tries to make requests to your backend API but the backend doesn't have the correct configuration to allow these requests from the frontend domain. The browser blocks these requests for security reasons.

Error message you might see in the console:
```
Access to fetch at 'https://manish-steel-api.vercel.app/api/health' from origin 'https://manish-steel-furniture-m9ayaff4c-manishh101s-projects.vercel.app' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource.
```

## 2. Update Backend Environment Variables

### If deployed on Render:

1. **Using the helper script (recommended):**
   - Run the helper script in this repository:
     ```
     ./update-render-cors.sh
     ```
   - Follow the prompts to set up CORS for your Render service

2. **Manual method:**
   - Log into your Render dashboard at https://dashboard.render.com
   - Select your backend service (manish-steel-api)
   - Go to "Environment" tab
   - Add or update this environment variable:
     - Key: `ALLOWED_ORIGINS`
     - Value: `https://manish-steel-furniture.vercel.app,https://manish-steel-furniture-m9ayaff4c-manishh101s-projects.vercel.app,https://manish-steel-furniture-git-main-manishh101s-projects.vercel.app,http://localhost:3000`
   - Click "Save Changes"
   - Your service will automatically redeploy with the new configuration

### If deployed on Vercel:

1. **Using the helper script (recommended):**
   - Run the helper script in this repository:
     ```
     ./deploy-cors-fix-vercel.sh
     ```
   - This will deploy your backend with the correct CORS configuration

2. **Manual method:**
   - Log into your Vercel dashboard
   - Select your backend project
   - Go to "Settings" > "Environment Variables"
   - Add or update this environment variable:
     - Key: `ALLOWED_ORIGINS`
     - Value: `https://manish-steel-furniture.vercel.app,https://manish-steel-furniture-m9ayaff4c-manishh101s-projects.vercel.app,https://manish-steel-furniture-git-main-manishh101s-projects.vercel.app,http://localhost:3000`
   - Click "Save"
   - Redeploy your backend by going to "Deployments" and clicking "Redeploy"

## 3. Verify the Fix

1. Wait for the backend to redeploy completely (this may take a few minutes)
2. Visit your frontend website
3. Open browser developer tools (F12 or Right-click > Inspect)
4. Go to the "Console" tab
5. Check if there are any CORS-related errors
6. Try to use features that require API calls (browsing products, viewing gallery, etc.)

## 4. Troubleshooting

If you're still seeing CORS errors:

1. Verify that the environment variable is set correctly with the exact frontend URL
2. Check that your frontend is using the correct backend URL (REACT_APP_API_URL in your frontend .env)
3. Ensure no typos in either URL
4. Check your backend logs for any CORS-related messages (you should see messages like "CORS blocked for origin: X" if the origin is being rejected)

## 5. For Local Development

When developing locally, you have two options:

1. Include `http://localhost:3000` in your ALLOWED_ORIGINS (recommended)
2. Create a local .env file with a different ALLOWED_ORIGINS value for development

Remember to restart your backend server after any changes to environment variables during local development.
